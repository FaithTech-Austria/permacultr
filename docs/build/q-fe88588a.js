const h=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}return"showOpenFilePicker"in self})(),b=h?Promise.resolve().then(function(){return g}):Promise.resolve().then(function(){return O});async function F(...e){return(await b).default(...e)}h?Promise.resolve().then(function(){return E}):Promise.resolve().then(function(){return I});const P=h?Promise.resolve().then(function(){return L}):Promise.resolve().then(function(){return j});async function U(...e){return(await P).default(...e)}const k=async e=>{const n=await e.getFile();return n.handle=e,n};var _=async(e=[{}])=>{Array.isArray(e)||(e=[e]);const n=[];e.forEach((a,o)=>{n[o]={description:a.description||"Files",accept:{}},a.mimeTypes?a.mimeTypes.map(i=>{n[o].accept[i]=a.extensions||[]}):n[o].accept["*/*"]=a.extensions||[]});const r=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:n,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),t=await Promise.all(r.map(k));return e[0].multiple?t:t[0]},g={__proto__:null,default:_};function m(e){function n(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var t=r.done;return Promise.resolve(r.value).then(function(a){return{value:a,done:t}})}return m=function(r){this.s=r,this.n=r.next},m.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(r){var t=this.s.return;return t===void 0?Promise.resolve({value:r,done:!0}):n(t.apply(this.s,arguments))},throw:function(r){var t=this.s.return;return t===void 0?Promise.reject(r):n(t.apply(this.s,arguments))}},new m(e)}const v=async(e,n,r=e.name,t)=>{const a=[],o=[];var i,s=!1,c=!1;try{for(var u,p=function(l){var d,y,f,w=2;for(typeof Symbol<"u"&&(y=Symbol.asyncIterator,f=Symbol.iterator);w--;){if(y&&(d=l[y])!=null)return d.call(l);if(f&&(d=l[f])!=null)return new m(d.call(l));y="@@asyncIterator",f="@@iterator"}throw new TypeError("Object is not async iterable")}(e.values());s=!(u=await p.next()).done;s=!1){const l=u.value,d=`${r}/${l.name}`;l.kind==="file"?o.push(l.getFile().then(y=>(y.directoryHandle=e,y.handle=l,Object.defineProperty(y,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>d})))):l.kind!=="directory"||!n||t&&t(l)||a.push(v(l,n,d,t))}}catch(l){c=!0,i=l}finally{try{s&&p.return!=null&&await p.return()}finally{if(c)throw i}}return[...(await Promise.all(a)).flat(),...await Promise.all(o)]};var A=async(e={})=>{e.recursive=e.recursive||!1,e.mode=e.mode||"read";const n=await window.showDirectoryPicker({id:e.id,startIn:e.startIn,mode:e.mode});return(await(await n.values()).next()).done?[n]:v(n,e.recursive,void 0,e.skipDirectory)},E={__proto__:null,default:A},x=async(e,n=[{}],r=null,t=!1,a=null)=>{Array.isArray(n)||(n=[n]),n[0].fileName=n[0].fileName||"Untitled";const o=[];let i=null;if(e instanceof Blob&&e.type?i=e.type:e.headers&&e.headers.get("content-type")&&(i=e.headers.get("content-type")),n.forEach((u,p)=>{o[p]={description:u.description||"Files",accept:{}},u.mimeTypes?(p===0&&i&&u.mimeTypes.push(i),u.mimeTypes.map(l=>{o[p].accept[l]=u.extensions||[]})):i?o[p].accept[i]=u.extensions||[]:o[p].accept["*/*"]=u.extensions||[]}),r)try{await r.getFile()}catch(u){if(r=null,t)throw u}const s=r||await window.showSaveFilePicker({suggestedName:n[0].fileName,id:n[0].id,startIn:n[0].startIn,types:o,excludeAcceptAllOption:n[0].excludeAcceptAllOption||!1});!r&&a&&a(s);const c=await s.createWritable();return"stream"in e?(await e.stream().pipeTo(c),s):"body"in e?(await e.body.pipeTo(c),s):(await c.write(await e),await c.close(),s)},L={__proto__:null,default:x},T=async(e=[{}])=>(Array.isArray(e)||(e=[e]),new Promise((n,r)=>{const t=document.createElement("input");t.type="file";const a=[...e.map(c=>c.mimeTypes||[]),...e.map(c=>c.extensions||[])].join();t.multiple=e[0].multiple||!1,t.accept=a||"",t.style.display="none",document.body.append(t);const o=c=>{typeof i=="function"&&i(),n(c)},i=e[0].legacySetup&&e[0].legacySetup(o,()=>i(r),t),s=()=>{window.removeEventListener("focus",s),t.remove()};t.addEventListener("click",()=>{window.addEventListener("focus",s)}),t.addEventListener("change",()=>{window.removeEventListener("focus",s),t.remove(),o(t.multiple?Array.from(t.files):t.files[0])}),"showPicker"in HTMLInputElement.prototype?t.showPicker():t.click()})),O={__proto__:null,default:T},S=async(e=[{}])=>(Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise((n,r)=>{const t=document.createElement("input");t.type="file",t.webkitdirectory=!0;const a=i=>{typeof o=="function"&&o(),n(i)},o=e[0].legacySetup&&e[0].legacySetup(a,()=>o(r),t);t.addEventListener("change",()=>{let i=Array.from(t.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(i=i.filter(s=>s.webkitRelativePath.split("/").every(c=>!e[0].skipDirectory({name:c,kind:"directory"})))):i=i.filter(s=>s.webkitRelativePath.split("/").length===2),a(i)}),"showPicker"in HTMLInputElement.prototype?t.showPicker():t.click()})),I={__proto__:null,default:S},R=async(e,n={})=>{Array.isArray(n)&&(n=n[0]);const r=document.createElement("a");let t=e;"body"in e&&(t=await async function(i,s){const c=i.getReader(),u=new ReadableStream({start:d=>async function y(){return c.read().then(({done:f,value:w})=>{if(!f)return d.enqueue(w),y();d.close()})}()}),p=new Response(u),l=await p.blob();return c.releaseLock(),new Blob([l],{type:s})}(e.body,e.headers.get("content-type"))),r.download=n.fileName||"Untitled",r.href=URL.createObjectURL(await t);const a=()=>{typeof o=="function"&&o()},o=n.legacySetup&&n.legacySetup(a,()=>o(),r);return r.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(r.href),3e4),a()}),r.click(),null},j={__proto__:null,default:R};export{F as n,U as o};
